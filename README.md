# spatialIndex
空间索引的各种实现:

- GeoHash.php geohash算法配合redis sorted set 优化；
- QuadTree.c/QuadTree.h   非满点四叉树

## usage
make
./test

## 问题
1. 需要上层逻辑保证所有节点的位置不能相同，否则在进行切分时可能进入无限切分
2. 象限内元素列表，时间复杂度优化为添加O(1), 删除O(N)
3. 动态更新位置
4. 临界问题

## 待商榷的实现
1. 元素移除后，四象限的元素个数总和小于父节点的阀值时如何进行合并：
    * 删除时合并；
    * 在插入新元素时进行惰性移除
    * 在插入新元素时进行惰性移除，根据次数进行惰性移除
2. 节点的位置更新后，如何更新四叉树？
    * 如果像暗黑破坏神附近玩家组队的，对位置信息不是特别的敏感：
        * 第一个方案是按照固定低频率进行更新
        * 第二个方案是副本入口的位置是固定的，可以以入口位置作为基准，划定一定范围内的玩家才加入四叉树
    * 如果对实时要求较高的，则采用类aoi进入圈和离开圈的方式进行更新，往往离开圈大于进入圈。